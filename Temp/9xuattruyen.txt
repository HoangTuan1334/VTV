# ğŸ“¦ Táº¡o bÃ¡o cÃ¡o vÃ  thÃ´ng tin truyá»‡n
if story_script and 'final_pages' in locals():
    # Táº¡o file info
    comic_info = {
        "title": story_script['title'],
        "art_style": story_script['art_style'],
        "num_pages": len(final_pages),
        "characters": story_script['characters'],
        "created_at": time.strftime("%Y-%m-%d %H:%M:%S"),
        "pages": []
    }
    
    for i, page_path in enumerate(final_pages):
        page_num = i + 1
        comic_info['pages'].append({
            "page_num": page_num,
            "file": page_path,
            "layout": selected_layouts[i]['layout_name'],
            "num_panels": len(panel_images[page_num])
        })
    
    # LÆ°u thÃ´ng tin truyá»‡n
    with open("final_comic/comic_info.json", "w", encoding="utf-8") as f:
        json.dump(comic_info, f, indent=2, ensure_ascii=False)
    
    # Táº¡o README - Xá»­ lÃ½ character appearance
    character_descriptions = []
    for c in story_script['characters']:
        if 'appearance' in c:
            app = c['appearance']
            desc = f"{app.get('age', 'unknown age')}, {app.get('hair', 'unknown hair')}, {app.get('eyes', 'unknown eyes')}"
        elif 'description' in c:
            # Fallback cho format cÅ©
            desc = c['description']
        else:
            desc = "No description available"
        character_descriptions.append(f'- **{c["name"]}** ({c.get("role", "unknown")}): {desc}')
    
    readme_content = f"""
# {story_script['title']}

## ThÃ´ng tin truyá»‡n
- **Phong cÃ¡ch**: {story_script['art_style']}
- **Thá»ƒ loáº¡i**: {story_script.get('genre', 'N/A')}
- **Sá»‘ trang**: {len(final_pages)}
- **Sá»‘ nhÃ¢n váº­t**: {len(story_script['characters'])}
- **NgÃ y táº¡o**: {time.strftime("%Y-%m-%d %H:%M:%S")}

## NhÃ¢n váº­t
{chr(10).join(character_descriptions)}

## Cáº¥u trÃºc
{chr(10).join([f'- Trang {p["page_num"]}: {p["layout"]} ({p["num_panels"]} panels)' for p in comic_info['pages']])}

## Files
- `comic_info.json`: ThÃ´ng tin chi tiáº¿t truyá»‡n
- `page_01.png` - `page_{len(final_pages):02d}.png`: CÃ¡c trang truyá»‡n

---
Táº¡o bá»Ÿi Comic Auto Creator vá»›i Gemini AI
"""
    
    with open("final_comic/README.md", "w", encoding="utf-8") as f:
        f.write(readme_content)
    
    print("\n" + "="*60)
    print("ğŸ‰ HOÃ€N THÃ€NH Táº O TRUYá»†N!")
    print("="*60)
    print(f"\nğŸ“š TÃªn truyá»‡n: {story_script['title']}")
    print(f"ğŸ“„ Sá»‘ trang: {len(final_pages)}")
    print(f"ğŸ¨ Phong cÃ¡ch: {story_script['art_style']}")
    print(f"\nğŸ“ Truyá»‡n Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trong folder: final_comic/")
    print(f"\nCÃ¡c file:")
    print(f"  - comic_info.json (thÃ´ng tin truyá»‡n)")
    print(f"  - README.md (hÆ°á»›ng dáº«n)")
    for page_path in final_pages:
        print(f"  - {os.path.basename(page_path)}")
    print("\n" + "="*60)
else:
    print("âŒ ChÆ°a Ä‘á»§ dá»¯ liá»‡u Ä‘á»ƒ hoÃ n thÃ nh. Vui lÃ²ng cháº¡y láº¡i cÃ¡c bÆ°á»›c trÆ°á»›c.")