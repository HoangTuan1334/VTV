# ğŸ“„ Gá»™p táº¥t cáº£ trang thÃ nh 1 file PDF
def create_comic_pdf(final_pages, output_filename="final_comic/TRUYEN_TRANH.pdf"):
    """
    Gá»™p táº¥t cáº£ trang PNG thÃ nh 1 file PDF duy nháº¥t
    """
    try:
        from PIL import Image
        
        if not final_pages:
            print("âŒ KhÃ´ng cÃ³ trang nÃ o Ä‘á»ƒ táº¡o PDF")
            return None
        
        print(f"\nğŸ“„ Äang táº¡o PDF tá»« {len(final_pages)} trang...")
        
        # Äá»c táº¥t cáº£ trang
        images = []
        for i, page_path in enumerate(final_pages):
            print(f"   Äá»c trang {i+1}/{len(final_pages)}: {page_path}")
            img = Image.open(page_path)
            
            # Convert sang RGB náº¿u cáº§n (PDF khÃ´ng há»— trá»£ RGBA)
            if img.mode != 'RGB':
                img = img.convert('RGB')
            
            images.append(img)
        
        # LÆ°u thÃ nh PDF (trang Ä‘áº§u tiÃªn lÃ m gá»‘c, cÃ¡c trang cÃ²n láº¡i append vÃ o)
        if len(images) > 0:
            print(f"\nğŸ’¾ Äang lÆ°u PDF: {output_filename}")
            images[0].save(
                output_filename,
                save_all=True,
                append_images=images[1:] if len(images) > 1 else [],
                resolution=300.0,  # 300 DPI
                quality=95,
                optimize=False
            )
            
            # Kiá»ƒm tra file size
            import os
            file_size = os.path.getsize(output_filename) / (1024 * 1024)  # MB
            
            print(f"\nâœ… ÄÃƒ Táº O PDF THÃ€NH CÃ”NG!")
            print(f"   ğŸ“ File: {output_filename}")
            print(f"   ğŸ“Š KÃ­ch thÆ°á»›c: {file_size:.2f} MB")
            print(f"   ğŸ“„ Sá»‘ trang: {len(images)}")
            
            return output_filename
        else:
            print("âŒ KhÃ´ng cÃ³ áº£nh nÃ o Ä‘á»ƒ táº¡o PDF")
            return None
            
    except Exception as e:
        print(f"\nâŒ Lá»—i táº¡o PDF: {e}")
        print("ğŸ’¡ Thá»­ cÃ i Ä‘áº·t: pip install Pillow")
        return None


# Táº¡o PDF náº¿u Ä‘Ã£ cÃ³ final_pages
if 'final_pages' in locals() and final_pages:
    print("\n" + "=" * 70)
    print("ğŸ“„ BÆ¯á»šC CUá»I: Táº O FILE PDF")
    print("=" * 70)
    
    pdf_file = create_comic_pdf(final_pages)
    
    if pdf_file:
        print("\n" + "=" * 70)
        print("ğŸ‰ HOÃ€N THÃ€NH TOÃ€N Bá»˜ QUY TRÃŒNH!")
        print("=" * 70)
        print(f"\nğŸ“š Truyá»‡n cá»§a báº¡n:")
        print(f"   - CÃ¡c trang PNG: final_comic/page_*.png")
        print(f"   - File PDF hoÃ n chá»‰nh: {pdf_file}")
        print(f"\nğŸ“– Báº¡n cÃ³ thá»ƒ Ä‘á»c truyá»‡n báº±ng:")
        print(f"   - Má»Ÿ file PDF báº±ng trÃ¬nh Ä‘á»c PDF")
        print(f"   - Hoáº·c xem tá»«ng trang PNG")
        print("=" * 70)
else:
    print("âŒ ChÆ°a cÃ³ dá»¯ liá»‡u trang. Vui lÃ²ng cháº¡y láº¡i cÃ¡c bÆ°á»›c trÆ°á»›c.")